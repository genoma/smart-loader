/*!
 * Copyright © 2013 Alessandro Vioni - coding - @jenoma
 *           © 2013 Marco Temperilli - images - @MARCOMAIK

 * MIT License

 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"),
 * to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

(function(t){"use strict";t.fn.smartLoader=function(e){var n={howManySeconds:1e3,lengthOfLoop:200,callback:function(){},errorCallback:function(){},theControl:"document"};return e=t.extend({},n,e),this.each(function(){function n(t){var e=t,n=[t.attr("src")];e.attr("src","smart-loader-loaders/white.png"),e.css({background:"url(smart-loader-loaders/SmartLoader30.gif)","background-repeat":"no-repeat","background-position":"center center"}),t=new Image,t.onload=function(){i++,e.attr("src",n[0])},t.src=n[0]}function a(t){var e=[t.attr("src")];t=new Image,t.onload=function(){i++},t.src=e[0]}function r(t){var n=(new Date).getTime()-l;i!==f&&n>=e.howManySeconds?(clearInterval(t),e.errorCallback.call(s)):i===f&&(clearInterval(t),e.callback.call(s))}var o,c=t("img"),l=(new Date).getTime(),i=0,s=jQuery(this),u=document.getElementsByTagName("img"),f=u.length;"document"===e.theControl?(c.each(function(){a(t(this))}),o=setInterval(function(){r(o)},e.lengthOfLoop)):"images"===e.theControl&&(c.each(function(){n(t(this))}),o=setInterval(function(){r(o)},e.lengthOfLoop))})}})(jQuery);